<!DOCTYPE html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<html>
<head>
  <title>WebSocket Handshake</title>
</head>
<body>
</body>
<script>
const params = new URL(window.location.href).searchParams;
const ws = new WebSocket('ws://localhost:3000?' + params.get('aesKey'));

ws.onopen = function() {
    console.log(encrypt('WebSocket'));
    ws.send(encrypt('WebSocket'));
};

ws.onmessage = function(e) { 
  console.log("Received: '" + e.data + "'");
};

function readStringFromFileAtPath(pathOfFileToReadFrom){
        var request = new XMLHttpRequest();
        request.open("GET", pathOfFileToReadFrom, false);
        request.send(null);
        var returnValue = request.responseText;

        return returnValue;
}

function encrypt(data) {
  if (!data) return null
    try {
      return CryptoJS.AES.encrypt(data, CryptoJS.enc.Utf8.parse("NdRgUkXp2s5v8y/A"), {
             mode: CryptoJS.mode.ECB,
              padding: CryptoJS.pad.Pkcs7
        }).toString();
    } catch {
         return null
    }
}

</script>
</html>